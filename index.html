<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Device Information Dashboard</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
          Oxygen, Ubuntu, Cantarell, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
        color: #333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        backdrop-filter: blur(10px);
      }

      .header {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
        padding: 40px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
      }

      .content {
        padding: 40px;
      }

      .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
        margin-bottom: 40px;
      }

      .info-card {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        border: 1px solid rgba(0, 0, 0, 0.05);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .info-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
      }

      .card-header {
        display: flex;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
      }

      .card-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 15px;
        font-size: 1.2rem;
      }

      .card-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: #333;
      }

      .info-item {
        margin-bottom: 15px;
      }

      .info-label {
        font-size: 0.9rem;
        color: #666;
        font-weight: 500;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .info-value {
        font-size: 1rem;
        color: #333;
        font-weight: 500;
        word-break: break-all;
        background: #f8f9fa;
        padding: 8px 12px;
        border-radius: 8px;
        border-left: 4px solid #4facfe;
      }

      .status-online {
        border-left-color: #4caf50 !important;
        background: #e8f5e8 !important;
      }

      .status-offline {
        border-left-color: #f44336 !important;
        background: #ffebee !important;
      }

      .performance-good {
        border-left-color: #4caf50 !important;
        background: #e8f5e8 !important;
      }

      .performance-warning {
        border-left-color: #ff9800 !important;
        background: #fff3e0 !important;
      }

      .performance-poor {
        border-left-color: #f44336 !important;
        background: #ffebee !important;
      }

      .session-section {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 30px;
      }

      .session-section h2 {
        font-size: 1.5rem;
        margin-bottom: 20px;
        text-align: center;
      }

      .session-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
      }

      .session-item {
        background: rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: 10px;
        backdrop-filter: blur(10px);
      }

      .session-label {
        font-size: 0.9rem;
        opacity: 0.8;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .session-value {
        font-size: 0.9rem;
        font-family: 'Courier New', monospace;
        word-break: break-all;
        background: rgba(255, 255, 255, 0.1);
        padding: 8px 12px;
        border-radius: 6px;
      }

      .loading {
        text-align: center;
        padding: 40px;
        color: #666;
      }

      .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #4facfe;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .footer {
        text-align: center;
        padding: 20px;
        color: #666;
        font-size: 0.9rem;
        border-top: 1px solid #eee;
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 2rem;
        }

        .content {
          padding: 20px;
        }

        .info-grid {
          grid-template-columns: 1fr;
          gap: 20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>üîç Device Information Dashboard</h1>
        <p>Comprehensive analysis of your device and browser characteristics</p>
      </div>

      <div class="content">
        <div id="loading" class="loading">
          <div class="spinner"></div>
          <p>Collecting device information...</p>
        </div>

        <div id="content" style="display: none">
          <!-- Session Information -->
          <div class="session-section">
            <h2>üîê Session Information</h2>
            <div class="session-grid">
              <div class="session-item">
                <div class="session-label">Session ID (SID)</div>
                <div class="session-value" id="sid"></div>
              </div>
              <div class="session-item">
                <div class="session-label">Session Fingerprint (SFP)</div>
                <div class="session-value" id="sfp"></div>
              </div>
            </div>
          </div>

          <!-- Device Information -->
          <div class="info-grid">
            <div class="info-card">
              <div class="card-header">
                <div
                  class="card-icon"
                  style="background: #e3f2fd; color: #1976d2"
                >
                  üåç
                </div>
                <div class="card-title">Location & Language</div>
              </div>
              <div class="info-item">
                <div class="info-label">Time Zone</div>
                <div class="info-value" id="timezone"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Primary Language</div>
                <div class="info-value" id="language"></div>
              </div>
              <div class="info-item">
                <div class="info-label">All Languages</div>
                <div class="info-value" id="languages"></div>
              </div>
            </div>

            <div class="info-card">
              <div class="card-header">
                <div
                  class="card-icon"
                  style="background: #f3e5f5; color: #7b1fa2"
                >
                  üíª
                </div>
                <div class="card-title">Browser & Platform</div>
              </div>
              <div class="info-item">
                <div class="info-label">User Agent</div>
                <div class="info-value" id="userAgent"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Platform</div>
                <div class="info-value" id="platform"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Vendor</div>
                <div class="info-value" id="vendor"></div>
              </div>
            </div>

            <div class="info-card">
              <div class="card-header">
                <div
                  class="card-icon"
                  style="background: #e8f5e8; color: #388e3c"
                >
                  üì±
                </div>
                <div class="card-title">Device Capabilities</div>
              </div>
              <div class="info-item">
                <div class="info-label">Touch Points</div>
                <div class="info-value" id="touchPoints"></div>
              </div>
              <div class="info-item">
                <div class="info-label">CPU Cores</div>
                <div class="info-value" id="cpuCores"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Device Memory (GB)</div>
                <div class="info-value" id="deviceMemory"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Do Not Track</div>
                <div class="info-value" id="doNotTrack"></div>
              </div>
            </div>

            <div class="info-card">
              <div class="card-header">
                <div
                  class="card-icon"
                  style="background: #fff3e0; color: #f57c00"
                >
                  üñ•Ô∏è
                </div>
                <div class="card-title">Display Information</div>
              </div>
              <div class="info-item">
                <div class="info-label">Screen Resolution</div>
                <div class="info-value" id="screenResolution"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Available Screen</div>
                <div class="info-value" id="availableScreen"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Color Depth</div>
                <div class="info-value" id="colorDepth"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Pixel Depth</div>
                <div class="info-value" id="pixelDepth"></div>
              </div>
            </div>

            <div class="info-card">
              <div class="card-header">
                <div
                  class="card-icon"
                  style="background: #e8f5e8; color: #388e3c"
                >
                  üåê
                </div>
                <div class="card-title">Network & Connectivity</div>
              </div>
              <div class="info-item">
                <div class="info-label">Connection Status</div>
                <div class="info-value" id="connectionStatus"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Connection Type</div>
                <div class="info-value" id="connectionType"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Download Speed (Mbps)</div>
                <div class="info-value" id="downlink"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Latency (ms)</div>
                <div class="info-value" id="latency"></div>
              </div>
              <div class="info-item">
                <div class="info-label">RTT (ms)</div>
                <div class="info-value" id="rtt"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Data Saver Mode</div>
                <div class="info-value" id="saveData"></div>
              </div>
            </div>

            <div class="info-card">
              <div class="card-header">
                <div
                  class="card-icon"
                  style="background: #fff3e0; color: #f57c00"
                >
                  ‚ö°
                </div>
                <div class="card-title">Performance Metrics</div>
              </div>
              <div class="info-item">
                <div class="info-label">Page Load Time (ms)</div>
                <div class="info-value" id="loadTime"></div>
              </div>
              <div class="info-item">
                <div class="info-label">DOM Ready (ms)</div>
                <div class="info-value" id="domReady"></div>
              </div>
              <div class="info-item">
                <div class="info-label">First Paint (ms)</div>
                <div class="info-value" id="firstPaint"></div>
              </div>
              <div class="info-item">
                <div class="info-label">First Contentful Paint (ms)</div>
                <div class="info-value" id="firstContentfulPaint"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Current FPS</div>
                <div class="info-value" id="currentFps"></div>
              </div>
              <div class="info-item">
                <div class="info-label">Memory Usage (MB)</div>
                <div class="info-value" id="memoryUsage"></div>
              </div>
            </div>

            <div class="info-card">
              <div class="card-header">
                <div
                  class="card-icon"
                  style="background: #fce4ec; color: #c2185b"
                >
                  üîß
                </div>
                <div class="card-title">Raw Signals</div>
              </div>
              <div class="info-item">
                <div class="info-label">Complete Signal String</div>
                <div
                  class="info-value"
                  id="signals"
                  style="font-size: 0.8rem; line-height: 1.4"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="footer">
        <p>
          Device information collected in real-time ‚Ä¢ Built for Netlify
          deployment
        </p>
      </div>
    </div>

    <script src="device.js"></script>
    <script>
      let getCurrentFps = null;

      async function displayDeviceInfo() {
        try {
          // Get session fingerprint and signals
          const { sid, sfp, signals } = await getSessionFingerprint();

          // Collect network and performance information
          const networkInfo = await collectNetworkInfo();
          const performanceInfo = collectPerformanceInfo();

          // Start FPS measurement
          getCurrentFps = startFPSMeasurement();

          // Parse signals
          const signalParts = signals.split('|');
          const [
            timezone,
            dnt,
            touch,
            lang,
            langs,
            userAgent,
            platform,
            vendor,
            hw,
            mem,
            scrSig,
          ] = signalParts;

          // Parse screen signature
          const [
            width,
            height,
            availWidth,
            availHeight,
            colorDepth,
            pixelDepth,
          ] = scrSig.split('x');

          // Update session information
          document.getElementById('sid').textContent = String(sid || '');
          document.getElementById('sfp').textContent = String(sfp || '');

          // Update location & language
          document.getElementById('timezone').textContent = String(
            timezone || 'Not available'
          );
          document.getElementById('language').textContent = String(
            lang || 'Not available'
          );
          document.getElementById('languages').textContent = String(
            langs || 'Not available'
          );

          // Update browser & platform
          document.getElementById('userAgent').textContent = String(
            userAgent || 'Not available'
          );
          document.getElementById('platform').textContent = String(
            platform || 'Not available'
          );
          document.getElementById('vendor').textContent = String(
            vendor || 'Not available'
          );

          // Update device capabilities
          document.getElementById('touchPoints').textContent = String(
            touch || '0'
          );
          document.getElementById('cpuCores').textContent = String(
            hw || 'Not available'
          );
          document.getElementById('deviceMemory').textContent = String(
            mem || 'Not available'
          );
          document.getElementById('doNotTrack').textContent = String(
            dnt || 'Not set'
          );

          // Update display information
          document.getElementById('screenResolution').textContent = `${String(
            width || '0'
          )} √ó ${String(height || '0')}`;
          document.getElementById('availableScreen').textContent = `${String(
            availWidth || '0'
          )} √ó ${String(availHeight || '0')}`;
          document.getElementById('colorDepth').textContent = String(
            colorDepth || 'Not available'
          );
          document.getElementById('pixelDepth').textContent = String(
            pixelDepth || 'Not available'
          );

          // Update network information
          const connectionStatusEl =
            document.getElementById('connectionStatus');
          connectionStatusEl.textContent = networkInfo.online
            ? 'üü¢ Online'
            : 'üî¥ Offline';
          connectionStatusEl.className =
            'info-value ' +
            (networkInfo.online ? 'status-online' : 'status-offline');

          document.getElementById('connectionType').textContent = String(
            networkInfo.connectionType || 'Unknown'
          );
          document.getElementById('downlink').textContent = String(
            networkInfo.downlink || 'Unknown'
          );

          const latencyEl = document.getElementById('latency');
          latencyEl.textContent = String(networkInfo.latency || 'Unknown');
          if (networkInfo.latency && networkInfo.latency !== 'N/A') {
            latencyEl.className =
              'info-value ' +
              (networkInfo.latency < 100
                ? 'performance-good'
                : networkInfo.latency < 300
                ? 'performance-warning'
                : 'performance-poor');
          }

          const rttEl = document.getElementById('rtt');
          rttEl.textContent = String(networkInfo.rtt || 'Unknown');
          if (networkInfo.rtt && networkInfo.rtt > 0) {
            rttEl.className =
              'info-value ' +
              (networkInfo.rtt < 50
                ? 'performance-good'
                : networkInfo.rtt < 150
                ? 'performance-warning'
                : 'performance-poor');
          }

          const saveDataEl = document.getElementById('saveData');
          saveDataEl.textContent = networkInfo.saveData
            ? 'üü¢ Enabled'
            : 'üî¥ Disabled';
          saveDataEl.className =
            'info-value ' +
            (networkInfo.saveData ? 'status-online' : 'status-offline');

          // Update performance information
          const loadTimeEl = document.getElementById('loadTime');
          loadTimeEl.textContent = String(performanceInfo.loadTime);
          if (
            performanceInfo.loadTime !== 'Not available' &&
            performanceInfo.loadTime > 0
          ) {
            loadTimeEl.className =
              'info-value ' +
              (performanceInfo.loadTime < 1000
                ? 'performance-good'
                : performanceInfo.loadTime < 3000
                ? 'performance-warning'
                : 'performance-poor');
          }

          const domReadyEl = document.getElementById('domReady');
          domReadyEl.textContent = String(performanceInfo.domContentLoaded);
          if (
            performanceInfo.domContentLoaded !== 'Not available' &&
            performanceInfo.domContentLoaded > 0
          ) {
            domReadyEl.className =
              'info-value ' +
              (performanceInfo.domContentLoaded < 500
                ? 'performance-good'
                : performanceInfo.domContentLoaded < 1500
                ? 'performance-warning'
                : 'performance-poor');
          }

          const firstPaintEl = document.getElementById('firstPaint');
          firstPaintEl.textContent = String(performanceInfo.firstPaint);
          if (
            performanceInfo.firstPaint !== 'Not available' &&
            performanceInfo.firstPaint > 0
          ) {
            firstPaintEl.className =
              'info-value ' +
              (performanceInfo.firstPaint < 500
                ? 'performance-good'
                : performanceInfo.firstPaint < 1500
                ? 'performance-warning'
                : 'performance-poor');
          }

          const firstContentfulPaintEl = document.getElementById(
            'firstContentfulPaint'
          );
          firstContentfulPaintEl.textContent = String(
            performanceInfo.firstContentfulPaint
          );
          if (
            performanceInfo.firstContentfulPaint !== 'Not available' &&
            performanceInfo.firstContentfulPaint > 0
          ) {
            firstContentfulPaintEl.className =
              'info-value ' +
              (performanceInfo.firstContentfulPaint < 800
                ? 'performance-good'
                : performanceInfo.firstContentfulPaint < 2000
                ? 'performance-warning'
                : 'performance-poor');
          }

          const currentFpsEl = document.getElementById('currentFps');
          currentFpsEl.textContent = String(
            performanceInfo.fps || 'Measuring...'
          );

          // Update memory usage
          if (performanceInfo.memoryUsage) {
            document.getElementById(
              'memoryUsage'
            ).textContent = `${performanceInfo.memoryUsage.used} / ${performanceInfo.memoryUsage.total} (Limit: ${performanceInfo.memoryUsage.limit})`;
          } else {
            document.getElementById('memoryUsage').textContent =
              'Not available';
          }

          // Update raw signals
          document.getElementById('signals').textContent = String(
            signals || ''
          );

          // Hide loading and show content
          document.getElementById('loading').style.display = 'none';
          document.getElementById('content').style.display = 'block';

          // Start updating FPS in real-time
          setInterval(() => {
            if (getCurrentFps) {
              const fps = getCurrentFps();
              if (fps > 0) {
                const currentFpsEl = document.getElementById('currentFps');
                currentFpsEl.textContent = String(fps);
                currentFpsEl.className =
                  'info-value ' +
                  (fps >= 60
                    ? 'performance-good'
                    : fps >= 30
                    ? 'performance-warning'
                    : 'performance-poor');
              }
            }
          }, 1000);
        } catch (error) {
          console.error('Error collecting device information:', error);
          document.getElementById('loading').innerHTML = `
                    <div style="color: #d32f2f; font-size: 1.2rem; margin-bottom: 10px;">‚ùå</div>
                    <p>Error loading device information. Please refresh the page.</p>
                `;
        }
      }

      // Initialize when page loads
      document.addEventListener('DOMContentLoaded', displayDeviceInfo);
    </script>
  </body>
</html>
